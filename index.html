<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Weather ML</title>
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <style>
            body {
                font-family: "Lato", sans-serif;
                font-size: 1.2em;
                line-height: 1.3;
                text-align: center;
            }

            #box {
                background-color: #eff;
                padding: 10px;
                border: 1px solid green;
                border-radius: 4px;
            }
        </style>
    </head>
    <body>
        <div id="box"><p>Received Messages and Replies</p></div>
        <div id="output"></div>

        <script>
            var ws = new WebSocket('wss://'+window.location.hostname+'/ws');

            function screenWrite(data) {
                data = JSON.parse(data);
                var counter = 0;
                var output = document.getElementById('output');
                data.forEach(function(elem) {
                    var p = document.createElement("p");
                    p.innerText = elem;
                    p.classList.add(counter % 2 ? 'right' : 'left');
                    output.appendChild(p);
                });
            }

            ws.onmessage = function(event) {
                screenWrite(event.data);
            };

            ws.onopen = function() {
                ws.send('hello');
            };

            setInterval(function() {
                ws.send('ping');
            }, 1000);
        </script>
    </body>
</html>
